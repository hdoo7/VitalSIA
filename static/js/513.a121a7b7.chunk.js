"use strict";(self.webpackChunkEVA_libre=self.webpackChunkEVA_libre||[]).push([[513],{38462:(e,n,o)=>{o.d(n,{A:()=>i});class i{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;this.bufferTime=e,this.audioToText=n,this.voiceManager=o,this.wordThreshold=i,this.isListening=!1}startListening(){return new Promise(((e,n)=>{console.log("Starting listening session..."),this.isListening=!0,this.audioToText.startContinuousRecognition((n=>{this.isListening&&e(n)})),this.audioToText.onerror=e=>{console.error("Error during speech recognition:",e),n(e)}}))}stopListening(){console.log("Stopping listening..."),this.isListening=!1,this.audioToText.stopRecognition()}enqueueText(e){return new Promise(((n,o)=>{console.log("Speaking text:",e),this.stopListening(),this.voiceManager.enqueueText(e).then((()=>{console.log("Finished speaking"),n(),setTimeout((()=>{this.resumeListening()}),this.bufferTime)})).catch((e=>{console.error("Error during speech:",e),o(e)}))}))}resumeListening(){console.log("Resuming listening..."),this.isListening=!0,this.startListening().then((e=>{this.detectInterruption(e)&&this.handleInterruption(e)})).catch((e=>{console.error("Error during resuming listening:",e)}))}detectInterruption(e){return e.split(" ").length>=this.wordThreshold}handleInterruption(e){console.log("User interruption detected: ".concat(e)),this.voiceManager.stopSpeech(),this.resumeListening()}resumeListeningAfterResponse(e){return new Promise((n=>{setTimeout((()=>{e("listening"),this.startListening().then((e=>{n(e)}))}),this.bufferTime)}))}}},42026:(e,n,o)=>{o.d(n,{A:()=>i});class i{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"webspeech";this.recognition=null,this.isRecognizing=!1,this.isManuallyStopped=!1,this.initRecognition(e)}initRecognition(e){"webspeech"===e?(this.recognition=new(window.SpeechRecognition||window.webkitSpeechRecognition),this.recognition.interimResults=!1,this.recognition.continuous=!0,this.recognition.lang="en-US"):console.error("Unsupported recognition type")}startContinuousRecognition(e){this.isRecognizing?(this.recognition.onend=()=>{this.isRecognizing=!1,this.startRecognitionProcess(e)},this.stopRecognition()):(this.isManuallyStopped=!1,this.startRecognitionProcess(e))}startRecognitionProcess(e){if(this.isRecognizing)return void console.warn("Recognition is already running, skipping start.");this.isRecognizing=!0;const n=[];this.recognition.onresult=o=>{const i=o.results;for(let e=o.resultIndex;e<i.length;e++)i[e].isFinal&&n.push(i[e][0].transcript.trim());e(n.join(" "))},this.recognition.onerror=n=>{"not-allowed"===n.error?(console.error("Recognition error: Microphone access was not allowed."),alert("Please allow microphone access to use the speech recognition feature."),this.stopRecognition()):"no-speech"===n.error?(console.warn("Recognition error: No speech detected."),this.isManuallyStopped||setTimeout((()=>{console.log("Restarting speech recognition after no-speech error..."),this.startRecognitionProcess(e)}),1e3)):(console.error("Recognition error:",n.error),this.stopRecognition())},this.recognition.onend=()=>{console.log("Speech recognition ended."),this.isRecognizing=!1,this.isManuallyStopped||(console.log("Restarting speech recognition..."),this.startRecognitionProcess(e))},this.recognition.start(),console.log("Speech recognition started.")}stopRecognition(){this.isRecognizing&&(this.isManuallyStopped=!0,this.recognition.stop(),console.log("Speech recognition stopped manually."),this.isRecognizing=!1)}}},43513:(e,n,o)=>{o.r(n),o.d(n,{start:()=>R,stop:()=>w});var i=o(42026),t=o(38462),s=o(96308);let r=null,c=null,g=null,l=0,h=0,a=[{french:"Bonjour",english:"Hello"},{french:"Merci",english:"Thank you"},{french:"Chat",english:"Cat"},{french:"Tet",english:"Head"},{french:"Maison",english:"House"}];const u=e=>{if(l<a.length){const n="Que veut dire ".concat(a[l].french," en anglais ?");e("talking"),r.enqueueText(n).then((()=>{e("listening"),console.log("Listening for user response..."),g.startListening().then((n=>{p(n,e)})).catch((e=>{console.error("Error during listening:",e)}))}))}else d(e)},p=(e,n)=>{const o=a[l],i=e.trim().toLowerCase(),t=o.english.toLowerCase();console.log("User answered: ".concat(i)),i.includes(t)?(h++,console.log("Correct!"),r.enqueueText("Correct !")):(console.log("Incorrect. The correct answer is: ".concat(o.english)),r.enqueueText("Incorrect. La r\xe9ponse correcte est: ".concat(o.english))),l++,u(n)},d=e=>{console.log("Quiz ended. You got ".concat(h," out of ").concat(a.length," correct.")),r.enqueueText("Vous avez termin\xe9 le quiz ! Vous avez obtenu ".concat(h," bonnes r\xe9ponses sur ").concat(a.length,".")),e("idle")},R=e=>{console.log("Initializing French Vocabulary Quiz..."),r=s.A.getInstance(e),c=new i.A("webspeech"),g=new t.A(1e3,c,r),l=0,h=0,r.findAndSetVoice("Google fran\xe7ais").then((()=>{console.log("Starting the quiz with the first question..."),r.enqueueText("Commen\xe7ons le quiz de vocabulaire en fran\xe7ais !"),u((()=>{}))}))},w=()=>{console.log("Stopping French Vocabulary Quiz..."),c&&c.stopRecognition(),r&&r.stopSpeech(),console.log("Quiz stopped.")}}}]);
//# sourceMappingURL=513.a121a7b7.chunk.js.map